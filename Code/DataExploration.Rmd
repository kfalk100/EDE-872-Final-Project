---
title: "ENV 872 Final Project Data Exploration"
output: pdf_document
editor_options: 
  chunk_output_type: console
---

``` {r Establish Working Directory, warning=FALSE, echo=FALSE, include=FALSE}
library(lubridate)
library(ggplot2)
library(mapview)
library(tidyverse)
library(here)
library(ggthemes)
library(RColorBrewer)
library(sf)
library(leaflet)

here()
```

``` {r Set Environment}
Ambient_Noise <- read.csv(here("Data/Processed/Ambient_Grouped.csv"))
Hemlock_Condition <- read.csv(here("Data/Processed/Hemlock_Grouped.csv"))
Road_Noise <- read.csv(here("Data/Processed/Road_Grouped.csv"))
Woodpeckers_Grouped <- read.csv(here("Data/Processed/Woodpeckers_Grouped.csv"))
# For Presence/Nonpresence
Woodpeckers_Delaware <- read.csv(here("Data/Processed/Woodpeckers_Delaware.csv"))
# Comprehensive
Woodpeckers_Date <- read.csv(here("Data/Processed/Dateincluded_Woodpeckers.csv"))
Woodpeckers_Date$Detection_Date <- ymd(Woodpeckers_Date$Detection_Date)

```

``` {r Set Theme}
TheTheme <- theme_solarized(base_size = 12) +
  theme(axis.text = element_text(color="black"),
                              legend.position = "right",
                              legend.text = element_text(size = 8, color = "black"),
                              legend.title = element_text(size = 10, color = "black", face = "bold"),
                              axis.title = element_text(size = 11, color = "black", face = "bold"),
                              plot.title = element_text(size = 11, color = "black", face = "bold"),
                              )
theme_set(TheTheme)

```

``` {r Table of Woodpecker Appearance per Year}
Woodpeckers_GroupedTrim <- Woodpeckers_Grouped %>% 
  select(c(Year:Detection_Count)) %>% 
  arrange(Year, Common_Name) %>% 
  group_by(Year, Common_Name) %>% 
  summarise(Total_Detections = sum(Detection_Count))
  
summary(Woodpeckers_GroupedTrim$Total_Detections)

```

``` {r / Line Plot of Species Appearance Over Time}
Species_over_time <- 
  ggplot(Woodpeckers_GroupedTrim, 
         aes(x=Year,
             y=Total_Detections,
             color=Common_Name)) +
  geom_line() +
  labs(
    x="Year",
    y="Number of Detections",
    title="Woodpecker Species Appearance (2014-2025)",
    color="Species"
  ) +
  scale_x_continuous(breaks=seq(2015,2025, by=2))
Species_over_time + scale_color_brewer(palette="Dark2")
```

``` {r Ambient Noise Averages}
Ambient_Noise_Average <- Ambient_Noise %>% 
  select(c(Year:Detection_Count)) %>% 
  arrange(Year, Common_Name) %>% 
  group_by(Year, Common_Name) %>% 
  summarise(Average_Noise = mean(Ambient_Noise))
  
summary(Ambient_Noise_Average$Average_Noise)

```

``` {r / Scatter Plot of Ambient Noise Over Time}
Noise_over_time <- 
  ggplot(Woodpeckers_Date,
         aes(x=Detection_Date,
             y=Ambient_Noise,
             color=Common_Name)) +
  geom_point() +
  labs(
    x="Date",
    y="Ambient Noise (dB)",
    title="Ambient Noise Levels (2014-2025)",
    color="Species") +
  scale_x_date(date_breaks = "2 year", date_labels = "%Y") +
  scale_y_continuous(breaks = c(30, 35, 40, 45, 50, 55, 60, 65))

Noise_over_time + scale_color_brewer(palette="Dark2")


```

``` {r Line Plot of Average Ambient Noise}
AverageAmbientPlot <-
  ggplot(Ambient_Noise_Average,
         aes(x=Year,
             y=Average_Noise,
             color=Common_Name)) +
  geom_line() +
  labs(
    x="Year",
    y="Average Ambient Noise (dB)",
    title="Average Ambient Noise Levels (2014-2025)",
    color="Species") +
  scale_y_continuous(breaks = c(38, 40, 42, 44, 46, 48, 50, 52)) +
  scale_x_continuous(breaks=seq(2015,2025, by=2))

AverageAmbientPlot + scale_color_brewer(palette="Dark2")
  

```

``` {r / Line Plot or Scatter Plot of Hemlock Condition Over Time}
Hemlock_over_time <-
  ggplot(Hemlock_Condition,
         aes(x=Year,
             y=Hemlock_Condition_Score,
             color=Common_Name)) +
  geom_point()

Hemlock_over_time
```

``` {r / Comparison of Hemlock Condition and Detection Count}


```

``` {r / Graph Monitoring Sites}
ObservationSites <- Woodpeckers_Delaware %>% 
  st_as_sf( coords = c('Longitude','Latitude'), 
    crs=4326
    )

MonitoringSites <- mapview(ObservationSites, 
        cex = 4,
        col.regions = "firebrick",
        layer.name = "Observation Sites",
        map.types = c("Esri.NatGeoWorldMap", "CartoDB.Positron", "Esri.WorldImagery")) 
MonitoringSites


```

``` {r Plot Species Observation Spatially}

MonitoringSitesFrequency <- ObservationSites, 
        cex = ,
        col.regions = "firebrick",
        layer.name = "Observation Sites",
        map.types = c("Esri.NatGeoWorldMap", "CartoDB.Positron", "Esri.WorldImagery")) 
MonitoringSites


```
