---
title: "Woodpecker Species Trends in Delaware Water Gap National Recreation Area"
subtitle: "[Project GitHub](https://github.com/kfalk100/EDE-872-Final-Project.git)"
author: "Kyle Falk, Trisha Belus, Sean Burke"
date: "2025-12-12"
output: html_document
toc_float: true
editor_options: 
  chunk_output_type: console
---

```{=tex}
\listoffigures
\listoftables
```
# 1) Rationale and Research Questions

The northeast region of the continental United States is an area of high population density, a pattern that persists among various states including Delaware. The Delaware Water Gap National Recreation Area is unique in that it is situated between two major interstates, the I-80 and the I-84. With a growing global population and sprawling urbanization, understanding the influence of development within close proximity to national protected areas is important for future urban planning. For this analysis, we chose to focus on point count data for four species of woodpeckers: downy woodpecker, pileated woodpecker, red-bellied woodpecker, and hairy woodpecker. Since woodpeckers reside in Delaware year-round, they are an appropriate species to chose when focusing on local environmental variables over time.

Ambient noise levels, the presence of road noise, and the hemlock tree condition score data are used as possible explanatory variables for the detection count of the woodpecker species. Ambient noise levels and the presence of road noise are used as indicators of human influence. Hemlock tree condition scores are representative of the condition of hemlocks, as woodpeckers have been known to exploit hemlock tree snags for nesting.This study will investigate the statistical significance of these possible explanatory variables on woodpecker detection count as well as the spatial variation in these variables.

# 2) Research Questions

**Question 1:** Is there a visual correlation between the possible explanatory variables (ambient noise, road noise, and hemlock condition) and the detection of woodpecker species in the Delaware Water Gap from 2014-2025?

**Question 2:** How does the appearance of woodpecker species, ambient noise, road noise, and hemlock condition vary spatially?

**Question 3:** Is there a statistical significance between the possible explanatory variables (ambient noise, road noise, and hemlock condition) and the detection of woodpecker species in the Delaware Water Gap from 2014-2025?

# 3) Dataset Information

The dataset used in this analysis was downloaded from the [Data.gov](https://catalog.data.gov/dataset/streamside-bird-monitoring-data-in-eastern-rivers-and-mountains-network-parks-2011-2025-da) federal database and is originally published from the National Park Service (NPS). The data was gathered as a part of the Eastern Rivers and Mountains Network Streamside Bird Monitoring Protocol. The dataset includes avian point counts from the following six different National Parks:

-   Allegheny Portage Railroad National Historic Site
-   Bluestone National Scenic River
-   Delaware Water Gap National Recreation Area
-   Fort Necessity National Battlefield
-   Friendship Hill National Historic Site
-   New River Gorge National Park and Preserve

The data was collected during the months of May and June from 2011-2025. Each park consisted of multiple sites with each site having three point count stations. The sites were sampled repeatedly, typically four times annually. Point counts were conducted for ten minutes each, providing ample data on the bird species detected.

| Information    | Description                                                                                                                          |
|------------------------|-----------------------------------------------|
| Data Publisher | Department of the Interior - National Park Service                                                                                   |
| Data Source    | <https://catalog.data.gov/dataset/streamside-bird-monitoring-data-in-eastern-rivers-and-mountains-network-parks-2011-2025-da>        |
| Variables Used | National Park, Site Name, Detection Date, Year, Ambient Noise, Road Noise, Common Name, Hemlock Condition Score, Latitude, Longitude |
| Data Range     | May 27th, 2011 to May 19th, 2025                                                                                                     |

: **Table 1:** Dataset Information

# 4) Data Wrangling


```{r / Install Packages & Establish Working Directory, include=FALSE}
library(lubridate)
library(ggplot2)
library(mapview)
library(tidyverse)
library(here)
library(ggthemes)
library(RColorBrewer)
library(sf)
library(leaflet)

getwd()
here()

```

```{r / Import Dataset, include=FALSE}
pointcount <- read.csv(file = here("Data","Raw","ERMN_StreamsideBirds_2315071_PointCount.csv"))

```

```{r / Change Date Objects and Create Year Column, include=FALSE}

pointcount$Start_Date_ISO <- ymd(pointcount$Start_Date_ISO)
class(pointcount$Start_Date_ISO)

pointcount<- pointcount %>%
  mutate(Year = year(Start_Date_ISO))

```

```{r / Wrangle Data for Main Dataset, include=FALSE}

woodpeckers_delaware <- pointcount %>%
  select(Unit_Code,
         Site_Name,
         Start_Date_ISO,
         Year,
         Ambient_Noise,
         Road_Noise,
         Common_Name,
         Hemlock_Condition_Score,
         Latitude,
         Longitude)%>%
  filter(!Common_Name %in% c("Unidentified Bird",
                             "Unidentified Woodpecker",
                             "Not Applicable")) %>%
  filter(Common_Name %in% c("Downy Woodpecker",
                            "Pileated Woodpecker",
                            "Red-bellied Woodpecker",
                            "Hairy Woodpecker")) %>%
  filter(Unit_Code %in% c("DEWA"))%>%
  rename(National_Park = Unit_Code) %>%
  rename(Detection_Date = Start_Date_ISO
         
```


```{r / Group by Location (site name), Time (year), Common Name and the Possible Explanatory Variables, include=FALSE}

woodpeckers_grouped <-woodpeckers_delaware %>%
  group_by(Site_Name,Year, Common_Name) %>%
  summarise(Detection_Count = n())

ambient_grouped <- woodpeckers_delaware %>%
  group_by(Site_Name,Year, Common_Name, Ambient_Noise) %>%
  summarise(Detection_Count = n())

road_grouped <- woodpeckers_delaware %>%
  group_by(Site_Name,Year, Common_Name, Road_Noise) %>%
  summarise(Detection_Count = n())

hemlock_grouped <- woodpeckers_delaware %>%
  group_by(Site_Name,Year, Common_Name, Hemlock_Condition_Score) %>%
  summarise(Detection_Count = n())

```


```{r / Woodpecker Species Appearance Per Year and Per Site, include=FALSE}
 ##woodpeckers_groupedtrim
detections_per_year <- woodpeckers_grouped %>% 
  select(c(Year:Detection_Count)) %>% 
  arrange(Year, Common_Name) %>% 
  group_by(Year, Common_Name) %>% 
  summarise(Total_Detections = sum(Detection_Count))

sites_observations_XY <- woodpeckers_delaware %>%
  select(Site_Name,Latitude,Longitude)%>%
  group_by(Site_Name,Latitude,Longitude)%>%
  summarise(total_detections = n())

sites_observations_XY_species <- woodpeckers_delaware %>%
  select(Site_Name,Latitude,Longitude,Common_Name)%>%
  group_by(Site_Name,Latitude,Longitude,Common_Name)%>%
  summarise(total_detections = n())

```

```{r / Average Ambient Noise Per Year, include=FALSE}

ambient_noise_average <- ambient_grouped %>% 
  select(c(Year:Detection_Count)) %>% 
  arrange(Year, Common_Name) %>% 
  group_by(Year, Common_Name) %>% 
  summarise(Average_Noise = mean(Ambient_Noise))

ambient_noise_averagepersite <- woodpeckers_delaware %>% 
  select(c(Detection_Date:Longitude)) %>% 
  group_by(Latitude, Longitude) %>% 
  summarise(Average_Noise = mean(Ambient_Noise))

```

```{r / Average Hemlock Per Site, include=FALSE}

hemlock_average_XY <- woodpeckers_delaware %>%
  select(Site_Name,Hemlock_Condition_Score,Latitude,Longitude)%>%
  group_by(Site_Name, Latitude, Longitude)%>%
  summarise(Average_Hemlock_Score = mean(Hemlock_Condition_Score))

hemlock_score_average <- hemlock_grouped %>% 
  select(c(Year:Detection_Count)) %>% 
  arrange(Year, Common_Name) %>% 
  group_by(Year, Common_Name) %>% 
  summarise(Average_Hemlock = mean(Hemlock_Condition_Score))

```


```{r / Road Noise Presence Per Site, Road Noise Proportion Per Year, include=FALSE}

road_noise_false_XY <- woodpeckers_delaware %>%
  filter(Road_Noise == "FALSE")%>%
  select(Site_Name,Road_Noise,Latitude,Longitude)%>%
  distinct(Site_Name, Latitude, Longitude)

road_noise_true_XY <- woodpeckers_delaware %>%
  filter(Road_Noise == "TRUE")%>%
  select(Site_Name,Road_Noise,Latitude,Longitude)%>%
  distinct(Site_Name, Latitude, Longitude)

roadnoiseproportionperyear <- road_grouped %>% 
  select(c(Year:Detection_Count)) %>% 
  group_by(Year, Road_Noise, Common_Name) %>% 
  summarise(Count = sum(Detection_Count))

```


# 5) Exploratory Analysis

The exploratory analysis of our data set is comprised of several plots and spatial map objects that relate our explanatory variables to woodpecker observations in the Delaware Water Gap National Park. First, the total observation count of all four species across all sites was plotted per year. This makes it possible to provide an understanding of the relative frequencies of woodpecker appearance in the park, as well as see how the population may have changed over time. Next, the explanatory variables were graphed over time. First, the ambient noise levels were plotted by date, to show the relative spread of the levels of noise present when a woodpecker is spotted. To provide further information, a line plot was produced to show the average ambient noise of all observations. Next, we decided to provide an analysis of road noise observations over time. The presence or absence of road noise was provided in the data, and we wished to explore the correlation between that and woodpecker appearance. As such, a plot was created comparing the presence or absence of road noise per year and by species. The final explanatory variable, hemlock condition, was graphed as an average value over time and by species. As a discrete value that is assigned per observation, we decided to see if there was differences each year in the average score, in order to see how it related to woodpecker appearance.

After plotting woodpecker appearance and the explanatory variables over time, our objective was to show the observation sites and frequency of woodpecker observations spatially. To begin, we have provided a mapview object with two layers, one with every observation site in the data, and the other showing each site with a size that varies based on the number of observations recorded at that site. Next, we wanted to provide readers with an understanding of how the explanatory variables differ spatially. As such, we created another mpaview object, with layers representing average ambient noise per site, sites with road noise, sites without road noise, and the average hemlock score per site.

```{r / Set Theme, include=FALSE}
TheTheme <- theme_solarized(base_size = 12) +
  theme(axis.text = element_text(color="black"),
                              legend.position = "right",
                              legend.text = element_text(size = 8, color = "black"),
                              legend.title = element_text(size = 10, color = "black", face = "bold"),
                              axis.title = element_text(size = 11, color = "black", face = "bold"),
                              plot.title = element_text(size = 11, color = "black", face = "bold"),
                              )
theme_set(TheTheme)

```

```{r / Line Plot of Species Appearance Over Time, echo=FALSE, fig.align='center', fig.cap="Line Plot of Species Appearance Over Time"}
Species_over_time <- 
  ggplot(detections_per_year, 
         aes(x=Year,
             y=Total_Detections,
             color=Common_Name)) +
  geom_line() +
  labs(
    x="Year",
    y="Number of Detections",
    title="Woodpecker Species Appearance (2014-2025)",
    color="Species"
  ) +
  scale_x_continuous(breaks=seq(2015,2025, by=2))
Species_over_time + scale_color_brewer(palette="Dark2")
```

```{r / Scatter Plot of Ambient Noise Over Time, echo=FALSE, fig.align='center', fig.cap="Scatter Plot of Ambient Noise Over Time"}
Noise_over_time <- 
  ggplot(woodpeckers_delaware,
         aes(x=Detection_Date,
             y=Ambient_Noise,
             color=Common_Name)) +
  geom_point() +
  labs(
    x="Date",
    y="Ambient Noise (dB)",
    title="Ambient Noise Levels (2014-2025)",
    color="Species") +
  scale_x_date(date_breaks = "2 year", date_labels = "%Y") +
  scale_y_continuous(breaks = c(30, 35, 40, 45, 50, 55, 60, 65))

Noise_over_time + scale_color_brewer(palette="Dark2")


```

```{r / Line Plot of Average Ambient Noise, echo=FALSE, fig.align='center', fig.cap= "Line Plot of Average Ambient Noise" }
AverageAmbientPlot <-
  ggplot(ambient_noise_average,
         aes(x=Year,
             y=Average_Noise,
             color=Common_Name)) +
  geom_line() +
  labs(
    x="Year",
    y="Average Ambient Noise (dB)",
    title="Average Ambient Noise Levels (2014-2025)",
    color="Species") +
  scale_y_continuous(breaks = c(38, 40, 42, 44, 46, 48, 50, 52)) +
  scale_x_continuous(breaks=seq(2015,2025, by=2))

AverageAmbientPlot + scale_color_brewer(palette="Dark2")
  

```


```{r}
RoadNoisePlot <- 
  ggplot(roadnoiseproportionperyear,
         aes(fill = Common_Name,
             y = Count,
             x = Year)) +
  geom_bar(position = "stack", stat = "identity") + 
  facet_wrap(~Road_Noise) +
  scale_x_continuous(breaks=seq(2015,2025, by=2)) +
  labs(x = "Year",
       y = "Observation Count",
       title = "Road Noise Presence per Observation (2014-2025)",
       fill = "Species") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
RoadNoisePlot + scale_fill_brewer(palette="Dark2")
```



```{r / Line Plot or Scatter Plot of Hemlock Condition Over Time, echo=FALSE, fig.align='center', fig.cap= "Line Plot or Scatter Plot of Hemlock Condition Over Time"}

Hemlock_over_time <-
  ggplot(hemlock_score_average,
         aes(x=Year,
             y=Average_Hemlock,
             color=Common_Name)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE, size = 0.5) +
  scale_x_continuous(breaks = seq(2015,2025, by = 2)) +
  scale_y_continuous(breaks = seq(0,5, by = 1)) +
  labs(title = "Average Hemlock Score for All Sites (2014-2025)",
       x = "Year",
       y = "Average Hemlock Score",
       color = "Species")
  
Hemlock_over_time + scale_color_brewer(palette="Dark2")

```


```{r / Comparison of Hemlock Condition and Detection Count}


```

```{r / Graph Monitoring Sites, echo=FALSE}
ObservationSites <- woodpeckers_delaware %>% 
  st_as_sf( coords = c('Longitude','Latitude'), 
    crs=4326
    )

MonitoringSites <- mapview(ObservationSites, 
        cex = 4,
        col.regions = "firebrick",
        layer.name = "Observation Sites",
        map.types = c("Esri.NatGeoWorldMap", "CartoDB.Positron", "Esri.WorldImagery")) 
MonitoringSites


```
**Map 1:** Observation Sites Spatially

```{r / Average Noise Spatially}

AverageNoisePerSiteSF <-ambient_noise_averagepersite %>% 
   st_as_sf(coords = c('Longitude','Latitude'), 
    crs=4326
    )

MonitoringSitesNoise <- mapview(AverageNoisePerSiteSF, 
        zcol = 'Average_Noise',
        alpha.regions = 0.4,
        layer.name = "Ambient Noise Level",
        map.types = c("Esri.NatGeoWorldMap", "CartoDB.Positron", "Esri.WorldImagery")) 
---
  
#hemlock_score_averagePerSite <- %>% 
  st_as_sf(coords = c('Longitude', 'Latitude'),
           crs=4326
           )

MonitoringSitesHemlock <- 
 
AllVariablesMapview <- mapview(MonitoringSitesNoise) +
  mapview()


```

**Map 2:** Species Observation Spatially



# 6) Analysis

# 7) Summary and Conclusions
